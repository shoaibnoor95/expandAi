Validation Epoch 20:  89%|████████▊ | 720/813 [37:45<04:49,  3.12s/it]
Validation Epoch 20:  89%|████████▊ | 721/813 [37:48<04:48,  3.14s/it]
Validation Epoch 20:  89%|████████▉ | 722/813 [37:51<04:47,  3.15s/it]
Validation Epoch 20:  89%|████████▉ | 723/813 [37:55<04:45,  3.17s/it]
Validation Epoch 20:  89%|████████▉ | 724/813 [37:58<04:42,  3.17s/it]
Validation Epoch 20:  89%|████████▉ | 725/813 [38:01<04:38,  3.17s/it]
Validation Epoch 20:  89%|████████▉ | 726/813 [38:04<04:35,  3.16s/it]
Validation Epoch 20:  89%|████████▉ | 727/813 [38:07<04:31,  3.15s/it]
Validation Epoch 20:  90%|████████▉ | 728/813 [38:10<04:28,  3.16s/it]
Validation Epoch 20:  90%|████████▉ | 729/813 [38:14<04:26,  3.18s/it]
Validation Epoch 20:  90%|████████▉ | 730/813 [38:17<04:22,  3.17s/it]
Validation Epoch 20:  90%|████████▉ | 731/813 [38:20<04:19,  3.16s/it]
Validation Epoch 20:  90%|█████████ | 732/813 [38:23<04:16,  3.16s/it]
Validation Epoch 20:  90%|█████████ | 733/813 [38:26<04:12,  3.16s/it]
Validation Epoch 20:  90%|█████████ | 734/813 [38:29<04:09,  3.15s/it]
Validation Epoch 20:  90%|█████████ | 735/813 [38:33<04:06,  3.17s/it]
Validation Epoch 20:  91%|█████████ | 736/813 [38:36<04:04,  3.17s/it]
Validation Epoch 20:  91%|█████████ | 737/813 [38:39<04:00,  3.17s/it]
Validation Epoch 20:  91%|█████████ | 738/813 [38:42<03:57,  3.16s/it]
Validation Epoch 20:  91%|█████████ | 739/813 [38:45<03:55,  3.18s/it]
Validation Epoch 20:  91%|█████████ | 740/813 [38:49<03:54,  3.21s/it]
Validation Epoch 20:  91%|█████████ | 741/813 [38:52<03:49,  3.18s/it]
Validation Epoch 20:  91%|█████████▏| 742/813 [38:55<03:45,  3.17s/it]
Validation Epoch 20:  91%|█████████▏| 743/813 [38:58<03:41,  3.16s/it]
Validation Epoch 20:  92%|█████████▏| 744/813 [39:01<03:38,  3.16s/it]
Validation Epoch 20:  92%|█████████▏| 745/813 [39:04<03:35,  3.17s/it]
Validation Epoch 20:  92%|█████████▏| 746/813 [39:07<03:32,  3.17s/it]
Validation Epoch 20:  92%|█████████▏| 747/813 [39:11<03:28,  3.16s/it]
Validation Epoch 20:  92%|█████████▏| 748/813 [39:14<03:25,  3.16s/it]
Validation Epoch 20:  92%|█████████▏| 749/813 [39:17<03:22,  3.17s/it]
Validation Epoch 20:  92%|█████████▏| 750/813 [39:20<03:20,  3.19s/it]
Validation Epoch 20:  92%|█████████▏| 751/813 [39:23<03:17,  3.18s/it]
Validation Epoch 20:  92%|█████████▏| 752/813 [39:27<03:13,  3.18s/it]
Validation Epoch 20:  93%|█████████▎| 753/813 [39:30<03:10,  3.18s/it]
Validation Epoch 20:  93%|█████████▎| 754/813 [39:33<03:06,  3.17s/it]
Validation Epoch 20:  93%|█████████▎| 755/813 [39:36<03:03,  3.17s/it]
Validation Epoch 20:  93%|█████████▎| 756/813 [39:39<03:00,  3.18s/it]
Validation Epoch 20:  93%|█████████▎| 757/813 [39:42<02:57,  3.17s/it]
Validation Epoch 20:  93%|█████████▎| 758/813 [39:45<02:53,  3.16s/it]
Validation Epoch 20:  93%|█████████▎| 759/813 [39:49<02:50,  3.16s/it]
Validation Epoch 20:  93%|█████████▎| 760/813 [39:52<02:47,  3.16s/it]
Validation Epoch 20:  94%|█████████▎| 761/813 [39:55<02:44,  3.17s/it]
Validation Epoch 20:  94%|█████████▎| 762/813 [39:58<02:41,  3.17s/it]
Validation Epoch 20:  94%|█████████▍| 763/813 [40:01<02:37,  3.16s/it]
Validation Epoch 20:  94%|█████████▍| 764/813 [40:04<02:35,  3.17s/it]
Validation Epoch 20:  94%|█████████▍| 765/813 [40:08<02:32,  3.17s/it]
Validation Epoch 20:  94%|█████████▍| 766/813 [40:11<02:29,  3.17s/it]
Validation Epoch 20:  94%|█████████▍| 767/813 [40:14<02:25,  3.17s/it]
Validation Epoch 20:  94%|█████████▍| 768/813 [40:17<02:22,  3.17s/it]
Validation Epoch 20:  95%|█████████▍| 769/813 [40:20<02:19,  3.18s/it]
Validation Epoch 20:  95%|█████████▍| 770/813 [40:24<02:16,  3.17s/it]
Validation Epoch 20:  95%|█████████▍| 771/813 [40:27<02:12,  3.16s/it]
Validation Epoch 20:  95%|█████████▍| 772/813 [40:30<02:09,  3.15s/it]
Validation Epoch 20:  95%|█████████▌| 773/813 [40:33<02:06,  3.16s/it]
Validation Epoch 20:  95%|█████████▌| 774/813 [40:36<02:03,  3.17s/it]
Validation Epoch 20:  95%|█████████▌| 775/813 [40:39<02:01,  3.19s/it]
Validation Epoch 20:  95%|█████████▌| 776/813 [40:43<01:57,  3.17s/it]
Validation Epoch 20:  96%|█████████▌| 777/813 [40:46<01:53,  3.15s/it]
Validation Epoch 20:  96%|█████████▌| 778/813 [40:49<01:49,  3.12s/it]
Validation Epoch 20:  96%|█████████▌| 779/813 [40:52<01:45,  3.10s/it]
Validation Epoch 20:  96%|█████████▌| 780/813 [40:55<01:42,  3.10s/it]
Validation Epoch 20:  96%|█████████▌| 781/813 [40:58<01:38,  3.09s/it]
Validation Epoch 20:  96%|█████████▌| 782/813 [41:01<01:35,  3.09s/it]
Validation Epoch 20:  96%|█████████▋| 783/813 [41:04<01:33,  3.11s/it]
Validation Epoch 20:  96%|█████████▋| 784/813 [41:07<01:30,  3.12s/it]
Validation Epoch 20:  97%|█████████▋| 785/813 [41:10<01:27,  3.12s/it]
Validation Epoch 20:  97%|█████████▋| 786/813 [41:14<01:24,  3.12s/it]
Validation Epoch 20:  97%|█████████▋| 787/813 [41:17<01:21,  3.12s/it]
Validation Epoch 20:  97%|█████████▋| 788/813 [41:20<01:17,  3.11s/it]
Validation Epoch 20:  97%|█████████▋| 789/813 [41:23<01:14,  3.12s/it]
Validation Epoch 20:  97%|█████████▋| 790/813 [41:26<01:12,  3.14s/it]
Validation Epoch 20:  97%|█████████▋| 791/813 [41:29<01:09,  3.15s/it]
Validation Epoch 20:  97%|█████████▋| 792/813 [41:32<01:05,  3.13s/it]
Validation Epoch 20:  98%|█████████▊| 793/813 [41:36<01:03,  3.16s/it]
Validation Epoch 20:  98%|█████████▊| 794/813 [41:39<01:00,  3.19s/it]
Validation Epoch 20:  98%|█████████▊| 795/813 [41:42<00:57,  3.18s/it]
Validation Epoch 20:  98%|█████████▊| 796/813 [41:45<00:53,  3.16s/it]
Validation Epoch 20:  98%|█████████▊| 797/813 [41:48<00:50,  3.16s/it]
Validation Epoch 20:  98%|█████████▊| 798/813 [41:51<00:47,  3.16s/it]
Validation Epoch 20:  98%|█████████▊| 799/813 [41:55<00:44,  3.17s/it]
Validation Epoch 20:  98%|█████████▊| 800/813 [41:58<00:41,  3.16s/it]
Validation Epoch 20:  99%|█████████▊| 801/813 [42:01<00:37,  3.16s/it]
Validation Epoch 20:  99%|█████████▊| 802/813 [42:04<00:34,  3.17s/it]
Validation Epoch 20:  99%|█████████▉| 803/813 [42:07<00:31,  3.19s/it]
Validation Epoch 20:  99%|█████████▉| 804/813 [42:11<00:28,  3.22s/it]
Validation Epoch 20:  99%|█████████▉| 805/813 [42:14<00:25,  3.22s/it]
Validation Epoch 20:  99%|█████████▉| 806/813 [42:17<00:22,  3.21s/it]
Validation Epoch 20:  99%|█████████▉| 807/813 [42:20<00:19,  3.21s/it]
Validation Epoch 20:  99%|█████████▉| 808/813 [42:23<00:15,  3.18s/it]
Validation Epoch 20: 100%|█████████▉| 809/813 [42:27<00:12,  3.18s/it]
Validation Epoch 20: 100%|█████████▉| 810/813 [42:30<00:09,  3.19s/it]
Validation Epoch 20: 100%|█████████▉| 811/813 [42:33<00:06,  3.18s/it]
Validation Epoch 20: 100%|█████████▉| 812/813 [42:36<00:03,  3.15s/it]
Validation Epoch 20: 100%|██████████| 813/813 [42:38<00:00,  2.81s/it]
Validation Epoch 20: 100%|██████████| 813/813 [42:38<00:00,  3.15s/it]
Optimizing thresholds...
Optimal thresholds: [0.1  0.15 0.1  0.5  0.25 0.1  0.75 0.3  0.3  0.1  0.1  0.8  0.15 0.25
 0.45 0.45 0.65 0.1  0.1 ]
Validation F1-score (Macro) with optimized thresholds: 0.7216
Final model saved to sewer_model.pth
